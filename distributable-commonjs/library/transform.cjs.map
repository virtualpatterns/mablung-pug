{"version":3,"sources":["../../source/library/transform.js"],"names":["DateTime","DefaultLuxon","ModuleLuxon","Lint","ESLint","Format","_Format","Babel","DefaultBabel","ModuleBabel","FilePath","__filename","Require","require","Transform","getAstFromContent","content","option","ast","token","path","Lex","Parse","Filter","handleFilters","getSourceFromContent","blockNode","BlockNode","blockSource","getSource","source","local","_getLocalFromSource","getFunctionSourceFromContent","map","join","getFunctionFromContent","formatSource","fn","eval","getModuleSourceFromContent","userOption","defaultOption","Package","name","version","utc","toFormat","Path","relative","utility","getAstFromPath","FileSystem","readFile","getSourceFromPath","getFunctionSourceFromPath","getFunctionFromPath","getModuleSourceFromPath","createModuleFromPath","sourcePath","targetPath","statSync","isDirectory","dirname","basename","extname","sourceInformation","stat","_createModuleFromPath","flat","includePattern","item","readdir","promise","concat","filter","folder","isFile","file","reduce","isMatch","pattern","Promise","all","isCreated","pathExists","targetInformation","mtimeMs","toLowerCase","ensureDir","writeFile","encoding","flag","sourceIn","environment","configuration","JSON5","parse","resolve","env","sourceOut","transformAsync","lint","result","lintText","messages","message","ruleId","match","Is","not","null","exec","UnrecognizedMessageTransformError","accumulator","undefined","Object","keys"],"mappings":"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","sourcesContent":["import DefaultBabel, * as ModuleBabel from '@babel/core'\nimport DefaultLuxon, * as ModuleLuxon from 'luxon'\nimport ESLint from 'eslint'\nimport FileSystem from 'fs-extra'\nimport Filter from 'pug-filters'\nimport _Format from 'prettier'\nimport Is from '@pwn/is'\nimport JSON5 from 'json5'\nimport Lex from 'pug-lexer'\nimport Link from 'pug-linker'\nimport Load from 'pug-load'\nimport Match from 'minimatch'\nimport Merge from 'deepmerge'\nimport Parse from 'pug-parser'\nimport Path from 'path'\n\nimport { Package } from './package.js'\nimport BlockNode from './node/block-node.js'\n\nimport { UnrecognizedMessageTransformError } from './error/unrecognized-message-transform-error.js'\n\nconst { DateTime } = DefaultLuxon || ModuleLuxon\nconst { 'ESLint': Lint } = ESLint\nconst { 'format': Format } = _Format\nconst Babel = DefaultBabel || ModuleBabel\nconst FilePath = __filePath\nconst Require = __require\n\nclass Transform {\n  \n  static getAstFromContent(content, option = { 'path': '(unknown)' }) {\n\n    let ast = null\n    let token = null\n    \n    token = Lex(content, { 'filename': option.path })\n    ast = Parse(token, { 'filename': option.path })\n    ast = Load(ast, { 'lex': Lex, 'parse': Parse })\n\n    Filter.handleFilters(ast)\n\n    ast = Link(ast)\n\n    return ast\n\n  }\n\n  static async getSourceFromContent(content, option = { 'path': '(unknown)' }) {\n\n    let ast = this.getAstFromContent(content, option)\n    let blockNode = new BlockNode(ast, option)\n    let blockSource = await blockNode.getSource()\n\n    let source = `  function __getNode(__utility = {}) { \n                      const __node = []\n                      ${blockSource}\n                      return __utility.getNode(__node)\n                    }`\n\n    let local = await this._getLocalFromSource(source)\n\n    return { source, local }\n\n  }\n\n  static async getFunctionSourceFromContent(content, option = { 'path': '(unknown)' }) {\n\n    let { source, local } = await this.getSourceFromContent(content, option)\n\n    local = local\n      .map((local) => `const { ${local} } = __local`)\n      .join('\\n')\n\n    source =  ` function __getNode(__local = {}, __utility = {}) {\n                  ${local}\n                  ${source} \n                  return __getNode(__utility) \n                }`\n\n    return source\n\n  }\n\n  static async getFunctionFromContent(content, option = { 'path': '(unknown)' }) {\n\n    let source = null\n    source = await this.getFunctionSourceFromContent(content, option)\n    source = await this.formatSource(source)\n\n    let fn = null\n    eval(`fn = ${source}`)\n\n    return fn\n\n  }\n\n  static async getModuleSourceFromContent(content, userOption = {}) {\n\n    let defaultOption = {\n      'path': '(unknown)',\n      'utility': '@virtualpatterns/mablung-pug/utility'\n    }\n\n    let option = Merge(defaultOption, userOption)\n\n    let source = null\n    source = await this.getFunctionSourceFromContent(content, { 'path': option.path })\n    source = `  // Created by ${Package.name} v${Package.version}\n                // Created at ${DateTime.utc().toFormat('yyyy-LL-dd HH:mm:ss')}\n                // Path = ${option.path === '(unknown)' ? option.path : `'${Path.relative('', option.path)}'`}\n                import { Utility } from '${option.utility}'\n                ${source}\n                export default function(__local = {}, __utility = Utility) { \n                  return __getNode(__local, __utility) \n                }`\n\n    return source\n\n  }\n\n  static async getAstFromPath(path) {\n\n    let content = await FileSystem.readFile(path, { 'encoding': 'utf-8' })\n    let ast = this.getAstFromContent(content, { 'path': path })\n\n    return ast\n\n  }\n\n  static async getSourceFromPath(path) {\n\n    let content = await FileSystem.readFile(path, { 'encoding': 'utf-8' })\n    let source = await this.getSourceFromContent(content, { 'path': path })\n\n    return source\n\n  }\n\n  static async getFunctionSourceFromPath(path) {\n\n    let content = await FileSystem.readFile(path, { 'encoding': 'utf-8' })\n    let source = await this.getFunctionSourceFromContent(content, { 'path': path })\n\n    return source\n\n  }\n\n  static async getFunctionFromPath(path) {\n\n    let content = await FileSystem.readFile(path, { 'encoding': 'utf-8' })\n    let fn = await this.getFunctionFromContent(content, { 'path': path })\n\n    return fn\n\n  }\n\n  static async getModuleSourceFromPath(path, option) {\n\n    let content = await FileSystem.readFile(path, { 'encoding': 'utf-8' })\n    let source = await this.getModuleSourceFromContent(content, { ...option, 'path': path })\n\n    return source\n\n  }\n\n  static async createModuleFromPath(sourcePath, targetPath = FileSystem.statSync(sourcePath).isDirectory() ? sourcePath : `${Path.dirname(sourcePath)}/${Path.basename(sourcePath, Path.extname(sourcePath))}${Path.extname(FilePath)}`, userOption = {}) {\n\n    let defaultOption = {\n      'encoding': 'utf-8',\n      'flag': 'wx'\n    }\n\n    let option = Merge(defaultOption, userOption)\n\n    let sourceInformation = await FileSystem.stat(sourcePath)\n\n    if (sourceInformation.isDirectory()) { \n      return (await this._createModuleFromPath(sourcePath, targetPath, option)).flat()\n    } else {\n      return this._createModuleFromPath(sourcePath, targetPath, option)\n    }\n  \n  }\n\n  static async _createModuleFromPath(sourcePath, targetPath, option) {\n//     console.log(`Transform._createModuleFromPath(\n//   '${Path.relative('', sourcePath)}', \n//   '${Path.relative('', targetPath)}', \n//   option\n// )`)\n\n    let sourceInformation = await FileSystem.stat(sourcePath)\n    // console.log(`sourceInformation.mtimeMs = ${sourceInformation.mtimeMs}`)\n\n    if (sourceInformation.isDirectory()) {\n  \n      let includePattern = [ '*.pug' ]\n      // let excludePattern = [ '*.skip.pug' ]\n\n      let item = await FileSystem.readdir(sourcePath, { 'encoding': 'utf-8', 'withFileTypes': true })\n  \n      let promise = []\n  \n      promise = promise.concat(item\n        .filter((item) => item.isDirectory())\n        .map((folder) => this.createModuleFromPath(`${sourcePath}/${folder.name}`, `${targetPath}/${folder.name}`, option)))\n  \n      promise = promise.concat(item\n        .filter((item) => item.isFile())\n        .filter((file) => includePattern.reduce((isMatch, pattern) => isMatch ? isMatch : Match(file.name, pattern), false))\n        // .filter((file) => !excludePattern.reduce((isMatch, pattern) => isMatch ? isMatch : Match(file.name, pattern), false))\n        .map((file) => this.createModuleFromPath(`${sourcePath}/${file.name}`, `${targetPath}/${Path.basename(file.name, Path.extname(file.name))}${Path.extname(FilePath)}`, option)))\n    \n      return Promise.all(promise)\n        \n    } else {\n\n      let isCreated = false\n\n      if (await FileSystem.pathExists(targetPath)) {\n\n        let targetInformation = await FileSystem.stat(targetPath)\n        // console.log(`targetInformation.mtimeMs = ${targetInformation.mtimeMs}`)\n\n        if (sourceInformation.mtimeMs >= targetInformation.mtimeMs) {\n          isCreated = true\n        }\n\n      } else {\n        isCreated = true\n      }\n\n      if (isCreated) {\n\n        let source = null\n        source = await this.getModuleSourceFromPath(sourcePath, option)\n        source = await this.formatSource(source, Path.extname(targetPath).toLowerCase() === '.cjs' ? 'commonjs' : 'esmodule')\n\n        await FileSystem.ensureDir(Path.dirname(targetPath))\n        await FileSystem.writeFile(targetPath, source, { 'encoding': option.encoding, 'flag': option.flag })\n\n      }\n\n      return targetPath\n\n    }\n\n  }\n\n  static async formatSource(sourceIn, environment = Path.extname(FilePath).toLowerCase() === '.cjs' ? 'commonjs' : 'esmodule') {\n\n    let configuration = null\n    configuration = JSON5.parse(await FileSystem.readFile(Require.resolve('./transform.babelrc.json')), { 'encoding': 'utf-8' })\n    configuration = configuration.env[environment]\n    \n    let { 'code': sourceOut } = await Babel.transformAsync(sourceIn, configuration)\n\n    sourceOut = Format(sourceOut, {\n      'arrowParens': 'always',\n      'bracketSpacing': true,\n      'parser': 'babel',\n      'quoteProps': 'preserve',\n      'semi': false,\n      'singleQuote': true,\n      'tabWidth': 2,\n      'trailingComma': 'none'\n    })\n\n    return sourceOut\n\n  }\n\n  static async _getLocalFromSource(source) {\n\n    let configuration = JSON5.parse(await FileSystem.readFile(Require.resolve('./transform.eslintrc.json')), { 'encoding': 'utf-8' })\n    let lint = new Lint({ 'baseConfig': configuration })\n\n    let result = await lint.lintText(source)\n    let pattern = /^'(.*)' is not defined.$/i\n\n    let local = null\n    local = result[0].messages\n      .filter((message) => message.ruleId === 'no-undef')\n      .map((message) => message.message)\n      .map((message) => {\n\n        let match = null\n\n        if (Is.not.null(match = pattern.exec(message))) {\n          let [ , local ] = match\n          return local\n        } else {\n          throw new UnrecognizedMessageTransformError(message)\n        }\n\n      })\n      .reduce((accumulator, local) => {\n        accumulator[local] = undefined\n        return accumulator\n      }, {})\n\n    local = Object.keys(local)\n\n    return local\n\n  }\n\n}\n\nexport { Transform }"],"file":"transform.cjs"}